<Question>
Consider the function \[ f(x) =
\begin{cases}
ax^2 & \text{if } x \geq a,\\
ax +2a& \text{if } x <a,
\end{cases}
\]where $a$ is some number.

What is the largest value of $a$ such that the graph of $y=f(x)$ intersects every horizontal line at least once?
</Question>

<think>
<Plan_1>
Okay, so I need to find the largest value of 'a' such that the graph of y = f(x) intersects every horizontal line at least once. The function f(x) is piecewise defined: it's ax² when x ≥ a, and ax + 2a when x < a. Hmm, let's break this down step by step.

First, let me recall that for a graph to intersect every horizontal line at least once, it must be surjective. In other words, for every real number y, there must exist some x such that f(x) = y. Since we're dealing with real numbers, surjectivity here means that the function covers all possible y-values.

Now, the function f(x) is composed of two parts: a quadratic function and a linear function. Depending on the value of 'a', these two pieces will have different shapes and domains.

Let me consider the two cases for x separately.

<prompt_1.1> Analyze the behavior of the function for x ≥ a and x < a, considering different values of a. </prompt_1.1>
</Plan_1>

<Execution_1>
<execution_1.1>
1. For x ≥ a: f(x) = a x². This is a quadratic function. If a is positive, this parabola opens upwards. If a is negative, it opens downwards. The vertex of this parabola is at (0, 0), but since x is restricted to x ≥ a, the domain of this quadratic part starts at x = a.

2. For x < a: f(x) = a x + 2a. This is a linear function with slope 'a' and y-intercept 2a. The domain here is all x less than a. So, depending on the value of 'a', this line could be increasing or decreasing.
</execution_1.1>
</Execution_1>

<Plan_2>
Based on execution_1.1:
The problem is to find the largest 'a' such that every horizontal line y = k intersects the graph of f(x). So, for every k, there exists some x where f(x) = k. To ensure this, both pieces of the function need to cover all possible y-values when combined.
However, since the function is piecewise, there might be a point where one of the pieces doesn't cover certain y-values, especially if there's a gap between the ranges of the two pieces.

Therefore, to have the entire function surjective, the ranges of the two pieces must overlap or connect in such a way that there's no gap in the y-values. Alternatively, even if their ranges don't overlap, each horizontal line might still intersect one of the pieces. But since the question is about intersecting every horizontal line at least once, we need to ensure that for every y, there's an x in either the quadratic or linear part such that f(x) = y.

So, let's analyze the ranges of each piece.

<prompt_2.1> Determine the conditions under which the ranges of the quadratic and linear parts overlap or cover all y-values. </prompt_2.1>
-----

But wait, let me think again. The problem is to find the largest a such that every horizontal line intersects the graph. So, if a is too large, maybe the linear part doesn't reach high enough or low enough to cover all y-values. For example, if a is positive, the linear part when x < a is y = a x + 2a.

<prompt_2.2> Re-evaluate the conditions for a when a is positive and when a is negative. </prompt_2.2>
</Plan_2>

<Execution_2>
<execution_2.1>
Starting with the quadratic part: f(x) = a x² for x ≥ a. The domain of this part is x ≥ a. Let's consider two cases: a positive and a negative.

Case 1: a > 0. Then, the quadratic function a x² opens upwards. Since x ≥ a (and a is positive), the smallest x is a. So, the minimum value of the quadratic part occurs at x = a. Plugging in x = a, we get f(a) = a*(a)^2 = a³. As x increases beyond a, the quadratic term a x² increases to infinity. Therefore, the range of the quadratic part when a > 0 is [a³, ∞).

Case 2: a < 0. Then, the quadratic function a x² opens downward. The coefficient a is negative, so as x increases, the value of a x² decreases. However, x is restricted to x ≥ a, which is a negative number since a is negative. The vertex of the parabola is at x = 0, but since x starts at a (which is negative), the minimum x is a. Wait, but if a is negative, x ≥ a includes all x from a (negative) to infinity. For a downward-opening parabola, the maximum value occurs at the vertex, but since the vertex is at x = 0, which is greater than a (since a is negative), the maximum value of the quadratic part is at x = 0: f(0) = 0. Then, as x moves away from 0 in either direction, the value decreases. However, since x is restricted to x ≥ a, which is to the left of 0 (if a is negative), the quadratic part will have a maximum at x = 0 (f(0) = 0) and decreases as x moves left (towards a) and right (away from 0). Wait, but x can't go left beyond a, since x ≥ a. So, when a is negative, the quadratic part is defined for x from a (negative) to infinity. The function a x², with a negative a, will have its maximum at x = 0 (if 0 is within the domain). If a is negative, then 0 is greater than a, so 0 is included in the domain x ≥ a. Therefore, the maximum value is at x = 0, which is 0. Then, as x moves left from 0 towards a, x is decreasing, but since a is negative, moving left from 0 would be more negative. However, x can't be less than a, so the leftmost point is x = a. So, at x = a, the value is a*(a)^2 = a³, which is negative because a is negative. Then, as x increases from a to 0, the quadratic function increases from a³ up to 0. Then, as x increases beyond 0, the quadratic function decreases again (since it's a downward-opening parabola). Therefore, the range of the quadratic part when a < 0 is (-∞, 0].
</execution_2.1>

<execution_2.2>
If a is positive, then as x approaches negative infinity, y approaches negative infinity because x is multiplied by a positive a. So, the linear part would cover from negative infinity up to the value when x approaches a from the left. That is, when x approaches a from below, y approaches a*a + 2a = a² + 2a. So, the linear part covers (-∞, a² + 2a).

The quadratic part for x ≥ a (and a is positive) is a parabola opening upwards, so its minimum value is at x = a. Plugging x = a into the quadratic gives f(a) = a*(a)^2 = a³. As x increases beyond a, the quadratic increases to infinity. So, the quadratic part covers [a³, ∞).

So, the total range of f(x) is the union of (-∞, a² + 2a) and [a³, ∞). For the function to cover all real numbers, these two intervals must overlap or be adjacent. That is, the maximum of the linear part (a² + 2a) must be greater than or equal to the minimum of the quadratic part (a³). So, we need a² + 2a ≥ a³.
</execution_2.2>
</Execution_2>

<Plan_3>
Based on execution_2.1:
Now, the linear part: f(x) = a x + 2a for x < a. Let's analyze its range.

<prompt_3.1> Analyze the range of the linear part for different values of a. </prompt_3.1>
-----

Based on execution_2.2:
Solving a² + 2a - a³ ≥ 0 => -a³ + a² + 2a ≥ 0 => a³ - a² - 2a ≤ 0.

Factorizing: a(a² - a - 2) ≤ 0 => a(a - 2)(a + 1) ≤ 0.

So, critical points at a = -1, 0, 2. Testing intervals:

<prompt_3.2> Solve the inequality a³ - a² - 2a ≤ 0 to find the values of a. </prompt_3.2>
</Plan_3>

<Execution_3>
<execution_3.1>
Again, considering two cases: a > 0 and a < 0.

Case 1: a > 0. The linear function has a positive slope. The domain here is x < a. As x approaches a from the left, f(x) approaches a*a + 2a = a² + 2a. As x approaches negative infinity, since the slope is positive, f(x) approaches negative infinity. Therefore, the range of the linear part when a > 0 is (-∞, a² + 2a).

Case 2: a < 0. The linear function has a negative slope (since a is negative). The domain is x < a (which is negative). Let's see the behavior as x approaches a from the left and as x approaches negative infinity. When x approaches a from the left, f(x) approaches a*a + 2a = a² + 2a. When x approaches negative infinity, since the slope is negative, f(x) = a x + 2a will approach positive infinity (because x is going to -∞, multiplied by a negative a gives positive infinity). Therefore, the range of the linear part when a < 0 is (a² + 2a, ∞).

Case 3: a = 0. Then, the function becomes f(x) = 0 for x ≥ 0, and f(x) = 0*x + 0 = 0 for x < 0. So, the function is always 0. This is a constant function, which only takes the value 0. Therefore, it does not intersect every horizontal line; only y = 0 is hit. So, a = 0 is invalid.
</execution_3.1>

<execution_3.2>
For a < -1: Let's pick a = -2. Then, (-2)(-2 -2)(-2 +1) = (-2)(-4)(-1) = (-2)(4) = -8 ≤ 0. So, inequality holds.

Between -1 and 0: a = -0.5. (-0.5)(-0.5 -2)(-0.5 +1) = (-0.5)(-2.5)(0.5) = (-0.5)(-1.25) = 0.625 > 0. Doesn't hold.

Between 0 and 2: a = 1. (1)(1 -2)(1 +1) = (1)(-1)(2) = -2 ≤ 0. Holds.

For a > 2: a = 3. (3)(3 -2)(3 +1) = 3*1*4 =12 >0. Doesn't hold.

So, the inequality a(a - 2)(a + 1) ≤ 0 holds when a ≤ -1 or 0 ≤ a ≤ 2.
</execution_3.2>
</Execution_3>

<Plan_4>
Based on execution_3.1:
Now, combining the ranges of both pieces:

<prompt_4.1> Combine the ranges of the quadratic and linear parts and determine the condition for the function to be surjective. </prompt_4.1>
-----

Based on execution_3.2:
But recall, our initial analysis was for a > 0. So, in the interval 0 < a ≤ 2, the inequality holds, meaning a² + 2a ≥ a³.

<prompt_4.2> Interpret the inequality a³ - a² - 2a ≤ 0 in the context of the problem to find the largest a. </prompt_4.2>
</Plan_4>

<Execution_4>
<execution_4.1>
- For a > 0: Quadratic part ranges [a³, ∞), linear part ranges (-∞, a² + 2a). The union of these two ranges is (-∞, a² + 2a) ∪ [a³, ∞). For the function to be surjective, these two intervals must cover the entire real line. Therefore, there must be no gap between them. That is, the maximum of the lower interval (a³) must be less than or equal to the minimum of the upper interval (a² + 2a). Wait, actually, to cover all y, the upper bound of the linear part must be greater than or equal to the lower bound of the quadratic part. So, we need a² + 2a ≥ a³. Because if a² + 2a ≥ a³, then the interval (-∞, a² + 2a) will extend up to at least a³, and [a³, ∞) starts at a³. Therefore, the union would be (-∞, ∞), which is surjective.

- For a < 0: Quadratic part ranges (-∞, 0], linear part ranges (a² + 2a, ∞). So, the union is (-∞, 0] ∪ (a² + 2a, ∞). For this to cover all real numbers, the point 0 must be greater than or equal to a² + 2a. Because otherwise, if a² + 2a > 0, then there's a gap between 0 and a² + 2a. So, we need 0 ≥ a² + 2a. Let's solve this inequality: a² + 2a ≤ 0 => a(a + 2) ≤ 0. The solutions are -2 ≤ a ≤ 0. But since we are considering a < 0, the valid interval is -2 ≤ a < 0.

Wait, but if a is negative, then a² + 2a = a(a + 2). So, when is a(a + 2) ≤ 0? The roots are a = 0 and a = -2. Testing intervals:

- For a < -2: a is negative, a + 2 is negative, so product is positive.
- For -2 < a < 0: a is negative, a + 2 is positive, so product is negative.
- At a = -2: product is 0.
- At a = 0: product is 0.

Therefore, a² + 2a ≤ 0 when -2 ≤ a ≤ 0. But since in this case, a < 0, so -2 ≤ a < 0. Therefore, for a in [-2, 0), the linear part's upper range starts at a² + 2a, which is ≤ 0, so the union with the quadratic part's (-∞, 0] would cover everything up to a² + 2a, but since a² + 2a ≤ 0, the upper part is (a² + 2a, ∞), which when combined with (-∞, 0] gives (-∞, ∞) only if a² + 2a ≤ 0. Wait, but if a² + 2a is less than 0, then the linear part's range is (a² + 2a, ∞), which includes (negative number, ∞), and the quadratic part's range is (-∞, 0]. So, the union would be (-∞, ∞) because (negative number, ∞) combined with (-∞, 0] covers all y. Wait, but if a² + 2a is negative, then (a² + 2a, ∞) starts before 0, so combined with (-∞, 0], the union is (-∞, ∞). Therefore, for a in [-2, 0], the function is surjective.
</execution_4.1>

<execution_4.2>
Therefore, for 0 < a ≤ 2, the ranges of the two pieces overlap or meet at a² + 2a, ensuring that every horizontal line is covered. However, when a > 2, the linear part's upper limit (a² + 2a) is less than the quadratic part's lower limit (a³), creating a gap between (a² + 2a, a³). Therefore, for a > 2, there are y-values in (a² + 2a, a³) that are not covered by either piece, meaning the horizontal lines y = k for k in that interval would not intersect the graph of f(x). Thus, to have the graph intersect every horizontal line, a must be ≤ 2.

But we need the largest value of a such that the condition holds. So, a = 2 is a candidate. However, we need to check if at a = 2, the ranges actually cover all y.

Let's check a = 2.

For a = 2:

Quadratic part: x ≥ 2, f(x) = 2x². The minimum value at x = 2 is 2*(2)^2 = 8, and it goes to infinity. So, range is [8, ∞).

Linear part: x < 2, f(x) = 2x + 4. Since a = 2 > 0, the linear part has a positive slope. As x approaches 2 from the left, f(x) approaches 2*2 + 4 = 8. As x approaches -∞, f(x) approaches -∞. So, the linear part's range is (-∞, 8). The quadratic part's range is [8, ∞). Therefore, the total range is (-∞, 8) ∪ [8, ∞) = (-∞, ∞). So, at a = 2, the function covers all real numbers. Therefore, a = 2 is acceptable.

But wait, the problem asks for the largest value of a. If a is slightly larger than 2, say a = 2.1, then according to the inequality, the ranges would not overlap, creating a gap. Let's verify with a = 2.1.

Quadratic part: x ≥ 2.1, f(x) = 2.1x². Minimum value at x = 2.1 is 2.1*(2.1)^2 = 2.1^3 ≈ 9.261. Range is [9.261, ∞).

Linear part: x < 2.1, f(x) = 2.1x + 4.2. Since a = 2.1 > 0, the linear part's range is (-∞, 2.1*(2.1) + 4.2) = (-∞, 4.41 + 4.2) = (-∞, 8.61). So, the quadratic part starts at ~9.261, leaving a gap between 8.61 and 9.261. Therefore, y-values in that interval are not covered, so horizontal lines in that interval don't intersect the graph. Therefore, a = 2.1 is invalid.

But wait, when a approaches 2 from above, what happens? Let's take a = 2 + ε, where ε is a small positive number.

Then, a³ = (2 + ε)^3 = 8 + 12ε + 6ε² + ε³.

a² + 2a = (4 + 4ε + ε²) + 4 + 2ε = 8 + 6ε + ε².

So, the gap between the linear part's maximum and quadratic part's minimum is a³ - (a² + 2a) = (8 + 12ε + 6ε² + ε³) - (8 + 6ε + ε²) = 6ε + 5ε² + ε³. For small ε > 0, this is positive, so there is a gap. Therefore, even for a slightly larger than 2, there is a gap, so the function does not intersect all horizontal lines. Therefore, a = 2 is the maximum value where the gap disappears.

But we need to check if a = 2 is indeed the supremum. What if we take a approaching 2 from below? Let's say a = 2 - ε, where ε is small positive.

Then, a³ = (2 - ε)^3 = 8 - 12ε + 6ε² - ε³.

a² + 2a = (4 - 4ε + ε²) + 4 - 2ε = 8 - 6ε + ε².

So, the upper bound of the linear part is 8 - 6ε + ε², and the lower bound of the quadratic part is 8 - 12ε + 6ε² - ε³. The difference is (8 - 12ε + 6ε² - ε³) - (8 - 6ε + ε²) = -6ε + 5ε² - ε³. For small ε > 0, this is negative, meaning the quadratic part's minimum is below the linear part's maximum. Therefore, the ranges overlap. So, for a < 2, the ranges overlap, ensuring surjectivity.

Therefore, the critical value is a = 2. At a = 2, the ranges just touch at y = 8, so every horizontal line is covered. For a > 2, there's a gap, and for a < 2, there's overlap. Therefore, the largest value of a is 2.
</execution_4.2>
</Execution_4>

<Plan_5>
Based on execution_4.2:
But let me verify once more.

Wait, when a = 2, the linear part's maximum is 8 (approached as x approaches 2 from the left), and the quadratic part starts at 8 (when x = 2). So, the function is continuous at x = 2?

<prompt_5.1> Verify the continuity of the function at x = 2 for a = 2 and confirm the surjectivity of the function. </prompt_5.1>
</Plan_5>

<Execution_5>
<execution_5.1>
Wait, let's check:

For x = 2, f(x) = 2*(2)^2 = 8.

For x approaching 2 from the left, f(x) = 2x + 4 approaches 2*2 + 4 = 8. So, yes, the function is continuous at x = 2 when a = 2.

But if a > 2, say a = 3, then at x = 3, quadratic part is 3*(3)^2 = 27, and linear part approaching 3 from the left would be 3*3 + 6 = 15. So, the function jumps from 15 to 27 at x = 3, leaving a gap between 15 and 27. Therefore, y-values between 15 and 27 are not covered. Hence, for a > 2, the function is not surjective.
</execution_5.1>
</Execution_5>

<Plan_6>
Based on execution_5.1:
But wait, when a = 2, the function is continuous at x = 2, and the ranges of the two pieces just meet at y = 8. So, for a = 2, every y is covered. If a is less than 2, say a = 1.9, then the quadratic part's minimum is (1.9)^3 ≈ 6.859, and the linear part's maximum is (1.9)^2 + 2*(1.9) = 3.61 + 3.8 = 7.41. Wait, but 6.859 is less than 7.41, so the quadratic part's minimum is below the linear part's maximum, meaning their ranges overlap. Therefore, for a < 2, the function's range is (-∞, a² + 2a) ∪ [a³, ∞), but since a³ < a² + 2a, the union is (-∞, ∞). Therefore, for a ≤ 2, the function is surjective. But when a > 2, the quadratic part's minimum is above the linear part's maximum, creating a gap. Therefore, the largest a is 2.

But let me check another angle. Suppose someone argues that even if there's a gap, maybe for some y in the gap, the quadratic or linear part could still cover it. But since the quadratic part starts at a³ when x ≥ a, and the linear part ends at a² + 2a when x < a, if a³ > a² + 2a, then there's a gap between a² + 2a and a³. For a > 2, this gap exists, so y-values in that interval are not covered by either piece. Therefore, to avoid the gap, we need a³ ≤ a² + 2a, which as we saw, holds when a ≤ 2. Hence, the maximum a is 2.

Additionally, we need to check the case when a is negative. Earlier, we found that for a in [-2, 0], the function is surjective. But since we are looking for the largest value of a, 2 is larger than 0, so 2 is the answer. Therefore, the answer should be a = 2.

But just to ensure thoroughness, let's consider a = 2 again. The function is continuous at x = 2, and the ranges of the two pieces meet exactly at y = 8. Therefore, every horizontal line y = k will intersect the graph: for k < 8, it intersects the linear part; for k ≥ 8, it intersects the quadratic part. Therefore, a = 2 is indeed the largest value where the function is surjective.

**Final Answer**
The largest value of \( a \) is \(\boxed{2}\).
</Plan_6>
</think>