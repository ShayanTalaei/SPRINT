Okay, so I have this problem here: Let ω ≠ 1 be a 13th root of unity. I need to find the remainder when the product from k=0 to 12 of (2 - 2ω^k + ω^{2k}) is divided by 1000. Hmm, that sounds a bit intimidating at first, but let me try to break it down step by step.

First, let's recall that ω is a primitive 13th root of unity. That means ω^13 = 1, and ω^k for k=0 to 12 are all distinct roots. The product we need to compute is over all these roots. The expression inside the product is 2 - 2ω^k + ω^{2k}. Let me write this down for a specific k to see if I can find a pattern or simplify it.

For each term in the product, it's 2 - 2ω^k + ω^{2k}. Let me see if I can factor this expression or relate it to something else. Maybe if I factor out something or write it in terms of ω^k. Let's denote z = ω^k. Then each term becomes 2 - 2z + z^2. Wait a minute, 2 - 2z + z^2 is a quadratic in z. Let me check if that factors. Let's compute the discriminant: b² - 4ac = (-2)^2 - 4*1*2 = 4 - 8 = -4. Since the discriminant is negative, this quadratic doesn't factor over the reals, but maybe over the complex numbers. However, since z is a root of unity, perhaps there's another way to approach this.

Alternatively, maybe we can write 2 - 2z + z² as (z - 1)^2 + 1. Let's check: (z - 1)^2 = z² - 2z + 1, so adding 1 gives z² - 2z + 2. Wait, that's exactly 2 - 2z + z². So, indeed, 2 - 2z + z² = (z - 1)^2 + 1. Hmm, interesting. So each term is (z - 1)^2 + 1. But I'm not sure if that helps directly. Maybe there's another way.

Alternatively, let's note that since ω is a root of the cyclotomic polynomial Φ₁₃(x) = x¹² + x¹¹ + ... + x + 1. So, ω^13 = 1, and 1 + ω + ω² + ... + ω¹² = 0. That might come in handy later.

Let me think about the product as a product over all 13th roots of unity (excluding 1) of (2 - 2ω^k + ω^{2k}). Wait, but the product is from k=0 to 12, which includes ω^0 = 1. But the problem states ω ≠ 1, so maybe the product is over all 13th roots except 1? Wait, the problem says "Let ω ≠ 1 be a 13th root of unity." Then the product is from k=0 to 12, which includes ω^0 = 1. But ω ≠ 1, so maybe in the product, we have (2 - 2ω^k + ω^{2k}) for each 13th root of unity, including 1. But since ω ≠ 1, does that mean the product is over all roots except 1? Wait, the problem is a bit ambiguous. Wait, re-reading: "Let ω ≠ 1 be a 13th root of unity. Find the remainder when [product from k=0 to 12 of (2 - 2ω^k + ω^{2k})] is divided by 1000."

So, the product is from k=0 to 12, which includes ω^0 = 1, even though ω ≠ 1. Wait, but if ω is a primitive 13th root, then ω^13 = 1, but ω^k for k=0 to 12 are all the roots. So, including k=0 gives ω^0 = 1. But the problem states ω ≠ 1, so is that a typo? Or maybe ω is a primitive root, so ω^0 = 1 is excluded? Wait, the problem says "Let ω ≠ 1 be a 13th root of unity." So, ω is a root of x¹³ - 1 = 0, but ω ≠ 1. Therefore, the roots are ω^0 = 1 is excluded? Wait, no, because ω^0 is 1 regardless. So, if ω is a primitive 13th root, then ω^0 = 1 is a 13th root, but ω^k for k=1 to 12 are the primitive roots. Wait, maybe the problem is saying "Let ω ≠ 1 be a 13th root of unity," so the product is over all roots, including 1, but ω is not 1. Hmm, that might not make sense because if ω ≠ 1, then the product is over all 13th roots except 1? Wait, but the product is from k=0 to 12, which includes 1. So perhaps the problem is using ω as a primitive root, so that ω^0 = 1 is excluded? Wait, perhaps the problem is written in a confusing way.

Wait, let's check. The problem says: "Let ω ≠ 1 be a 13th root of unity. Find the remainder when [product from k=0 to 12 of (2 - 2ω^k + ω^{2k})] is divided by 1000."

So, the product is from k=0 to 12, which includes ω^0 = 1. But ω ≠ 1. So, maybe the product is over all ω^k for k=0 to 12, but ω ≠ 1. But that would be the same as the product over all 13th roots of unity except 1. Wait, but 1 is a 13th root of unity, so if we exclude it, we have the product over the primitive 13th roots. Wait, but the product is over all 13th roots of unity, including 1, but with ω ≠ 1. That seems conflicting. Maybe the problem is written as ω ≠ 1, but the product is over all ω^k, including 1. Maybe the problem is correct as written, and we just need to compute the product over all 13th roots of unity, which includes 1, but ω is a root ≠ 1. So, perhaps we can compute the product over all 13th roots of unity, which is a standard technique in cyclotomic polynomials.

Alternatively, maybe the problem is written correctly, and we need to compute the product over all 13th roots of unity, including ω^0 = 1, even though ω ≠ 1. That seems a bit odd, but maybe it's intended.

In any case, perhaps the key is to notice that the product is over all 13th roots of unity, and the expression is a quadratic in ω^k. So, maybe we can express the product as the product over all roots of a certain polynomial.

Let me think: Let me denote x = ω^k. Then each term is 2 - 2x + x². So, the product over k=0 to 12 of (2 - 2x + x²) where x runs over all 13th roots of unity. Therefore, the product is equal to the product over all x^13 = 1 of (x² - 2x + 2). That is, the product over all 13th roots of x² - 2x + 2. So, if we can compute the product of (x² - 2x + 2) for all x such that x^13 = 1, then that's the answer.

But how do we compute such a product? There is a standard result in algebra that the product over all roots of unity of a polynomial evaluated at those roots can be related to the resultant or something else. Wait, but here it's the product of a quadratic evaluated at each root. Let me recall that if we have a polynomial f(x) and a set of roots {x_i}, then the product over f(x_i) can be expressed as the resultant of f(x) and the minimal polynomial of x_i.

But maybe more straightforwardly, since the roots x_i are the 13th roots of unity, the product over (x_i² - 2x_i + 2) can be related to evaluating another polynomial at certain points.

Alternatively, note that the product over x^13 = 1 of (x² - 2x + 2) is equal to the resultant of the polynomials x^13 - 1 and x² - 2x + 2. The resultant is the product of (a² - 2a + 2) where a runs over the roots of x^13 - 1. But how do we compute that resultant?

Alternatively, there's a formula for the product over roots of a polynomial f(x) of another polynomial g(x). The product is equal to the resultant of f and g, which can also be computed as the product of g(a) where a runs over the roots of f. So, in this case, the product is the resultant of x^13 - 1 and x² - 2x + 2. But computing the resultant might be complicated.

Alternatively, perhaps we can note that the product over x^13 = 1 of (x² - 2x + 2) is equal to the product over x^13 = 1 of (x - (1 + i))(x - (1 - i)), since x² - 2x + 2 factors as (x - (1 + i))(x - (1 - i)). Therefore, the product becomes the product over x^13 = 1 of (x - (1 + i))(x - (1 - i)). Which is equal to [Product over x^13 = 1 of (x - (1 + i))] * [Product over x^13 = 1 of (x - (1 - i))].

But the product over x^13 = 1 of (x - a) is equal to the polynomial evaluated at a, but since x^13 - 1 = 0 for all x, the product is equal to a^13 - 1. Wait, no. Wait, the product over all roots of (x - a) for x^13 = 1 is equal to (a^13 - 1). Wait, actually, if we consider the polynomial x^13 - 1 = product_{k=0}^{12} (x - ω^k). So, if we take the product over k=0 to 12 of (ω^k - a) = (-1)^13 * (a^13 - 1) = -(a^13 - 1). Wait, but in our case, the product is over (x - a) where x^13 = 1. Wait, maybe I need to think again.

Wait, the product over x^13 = 1 of (x - a) is equal to the value of the polynomial x^13 - 1 evaluated at x = a, but that's not exactly. Wait, more precisely, if we have a polynomial f(x) with roots r1, r2, ..., rn, then the product over (x - ri) is f(x). So, if we take the product over all roots ri of (ri - a), that's equivalent to evaluating the polynomial at x = a, but with x replaced by a. Wait, maybe not.

Wait, actually, the product over (x - ri) is f(x), so if we set x = a, then product over (a - ri) = f(a). So, product over (a - ri) = f(a). Therefore, product over (ri - a) = (-1)^n product over (a - ri) = (-1)^n f(a), where n is the degree of f. Since f(x) = x^13 - 1, which has degree 13. Therefore, product over (ri - a) = (-1)^13 f(a) = -f(a) = -(a^13 - 1) = 1 - a^13.

But in our case, the product over (x - a) where x runs over the roots of x^13 - 1 is equal to the product over (x - a) for x^13 = 1. Wait, but we have the product over (x - a) for each root x of x^13 - 1. Wait, but in our problem, the product is over (x² - 2x + 2) for x^13 = 1. Which factors into (x - (1 + i))(x - (1 - i)). Therefore, the product over x^13 = 1 of (x - (1 + i))(x - (1 - i)) is equal to [product over x^13 = 1 of (x - (1 + i))] * [product over x^13 = 1 of (x - (1 - i))].

Using the previous result, each product is equal to 1 - (1 + i)^13 and 1 - (1 - i)^13, respectively. Therefore, the total product is [1 - (1 + i)^13][1 - (1 - i)^13]. Therefore, the original product is equal to [1 - (1 + i)^13][1 - (1 - i)^13]. Let me compute that.

First, compute (1 + i)^13 and (1 - i)^13. Note that 1 + i and 1 - i are complex conjugates. Let's compute (1 + i)^13.

First, write 1 + i in polar form. The modulus is sqrt(1² + 1²) = sqrt(2), and the argument is π/4. Therefore, (1 + i) = sqrt(2) e^{iπ/4}. Therefore, (1 + i)^13 = (sqrt(2))^13 e^{i13π/4}.

Similarly, (1 - i) = sqrt(2) e^{-iπ/4}, so (1 - i)^13 = (sqrt(2))^13 e^{-i13π/4}.

Let's compute (sqrt(2))^13. sqrt(2) is 2^(1/2), so (2^(1/2))^13 = 2^(13/2) = 2^6 * 2^(1/2) = 64 * sqrt(2). Similarly, (sqrt(2))^13 = 64 * sqrt(2).

Now, the exponentials: e^{i13π/4} and e^{-i13π/4}. Let's compute 13π/4. 13 divided by 4 is 3 with a remainder of 1, so 13π/4 = 3π + π/4. But since angles are periodic modulo 2π, 13π/4 - 2π = 13π/4 - 8π/4 = 5π/4. So, e^{i13π/4} = e^{i5π/4} = cos(5π/4) + i sin(5π/4) = -√2/2 - i√2/2.

Similarly, e^{-i13π/4} = e^{-i5π/4} = cos(-5π/4) + i sin(-5π/4) = cos(5π/4) - i sin(5π/4) = -√2/2 + i√2/2.

Therefore, (1 + i)^13 = 64 * sqrt(2) * (-√2/2 - i√2/2) = 64 * sqrt(2) * (-√2/2)(1 + i) = 64 * ( - (2)/2 )(1 + i) = 64 * (-1)(1 + i) = -64(1 + i).

Similarly, (1 - i)^13 = 64 * sqrt(2) * (-√2/2 + i√2/2) = 64 * sqrt(2) * (-√2/2)(1 - i) = 64 * (-1)(1 - i) = -64(1 - i).

Therefore, [1 - (1 + i)^13] = 1 - (-64)(1 + i) = 1 + 64(1 + i) = 1 + 64 + 64i = 65 + 64i.

Similarly, [1 - (1 - i)^13] = 1 - (-64)(1 - i) = 1 + 64(1 - i) = 1 + 64 - 64i = 65 - 64i.

Therefore, the product is (65 + 64i)(65 - 64i). Let's compute that. The product of a complex number and its conjugate is the square of the modulus. So, |65 + 64i|² = 65² + 64². Let's compute that:

65² = 4225

64² = 4096

4225 + 4096 = 8321

Therefore, the product is 8321. Therefore, the original product is 8321. So, the answer is 8321 mod 1000, which is 321. Wait, but hold on. Wait, let me verify.

Wait, the product over all roots of (x² - 2x + 2) is equal to [1 - (1 + i)^13][1 - (1 - i)^13] = 8321. Then the original product is 8321. Therefore, 8321 divided by 1000 leaves a remainder of 321. Therefore, the answer is 321.

But wait, hold on. Let me check the steps again to make sure I didn't make a mistake.

First, we expressed each term as (x - (1 + i))(x - (1 - i)), then the product over all 13th roots of x is equal to the product over x^13 = 1 of (x - (1 + i))(x - (1 - i)).

Then, we said that product over (x - a) for x^13 = 1 is equal to 1 - a^13, but actually, the product over (x - a) for x^13 = 1 is equal to the product over roots of x^13 - 1 of (x - a) = (-1)^13 * (a^13 - 1) = 1 - a^13. Wait, but the product over (x - a) for x^13 = 1 is equal to (a^13 - 1), but with a sign change? Wait, maybe I need to check.

Wait, the product over (x - a) for x^13 = 1 is equal to the value of the polynomial x^13 - 1 evaluated at x = a, but that's not exactly. Wait, when you have a polynomial P(x) = (x - x1)(x - x2)...(x - xn), then if you substitute x = a, you get P(a) = (a - x1)(a - x2)...(a - xn). Therefore, the product over (a - xi) is P(a). But in our case, the product is over (xi - a), which is (-1)^n times the product over (a - xi) = (-1)^n P(a). Since P(x) = x^13 - 1, P(a) = a^13 - 1. Therefore, product over (xi - a) = (-1)^13 (a^13 - 1) = - (a^13 - 1) = 1 - a^13.

Therefore, the product over (xi - a) is 1 - a^13. Therefore, product over (x - a) is (a^13 - 1). Wait, maybe not. Wait, if you have product over (x - a) with x being the roots of P(x) = x^13 - 1, then since P(x) = (x - x1)...(x - x13), then product over (x - a) is P(a). Therefore, product over (x - a) = a^13 - 1. So, if we take product over (xi - a) = product over (xi - a) = product over ( - (a - xi) ) = (-1)^13 product over (a - xi) = - product over (a - xi) = - (a^13 - 1) = 1 - a^13.

Therefore, product over (xi - a) = 1 - a^13, and product over (x - a) = a^13 - 1. So, in our case, the product over (x - (1 + i)) is (1 + i)^13 - 1, and product over (x - (1 - i)) is (1 - i)^13 - 1. Wait, but earlier I thought it was 1 - a^13. Wait, now I'm confused.

Wait, if product over (x - a) = a^13 - 1, then product over (x - (1 + i)) would be (1 + i)^13 - 1. Similarly, product over (x - (1 - i)) is (1 - i)^13 - 1. Then the total product is [(1 + i)^13 - 1][(1 - i)^13 - 1]. But in my previous calculation, I used [1 - (1 + i)^13][1 - (1 - i)^13], which is different. So, that might be where the mistake is.

Wait, so there's a discrepancy here. Let's clarify.

If P(x) = x^13 - 1, then product over (x - a) = P(a) = a^13 - 1. Therefore, product over (x - a) = a^13 - 1. Therefore, if we set a = 1 + i, product over (x - (1 + i)) = (1 + i)^13 - 1. Similarly, product over (x - (1 - i)) = (1 - i)^13 - 1. Therefore, the total product is [(1 + i)^13 - 1][(1 - i)^13 - 1]. But in my earlier calculation, I had [1 - (1 + i)^13][1 - (1 - i)^13], which is different. Therefore, I made a mistake there.

Therefore, need to correct that.

So, let's recompute. First, compute (1 + i)^13 and (1 - i)^13.

As before, (1 + i) = sqrt(2) e^{iπ/4}, so (1 + i)^13 = (sqrt(2))^13 e^{i13π/4} = 64 sqrt(2) e^{i5π/4} = 64 sqrt(2)(cos(5π/4) + i sin(5π/4)) = 64 sqrt(2)(-√2/2 - i√2/2) = 64 * (-1 - i) = -64(1 + i).

Similarly, (1 - i)^13 = (sqrt(2))^13 e^{-i13π/4} = 64 sqrt(2) e^{-i5π/4} = 64 sqrt(2)(cos(-5π/4) + i sin(-5π/4)) = 64 sqrt(2)(-√2/2 + i√2/2) = 64*(-1 + i) = -64(1 - i).

Therefore, (1 + i)^13 = -64(1 + i), and (1 - i)^13 = -64(1 - i).

Therefore, (1 + i)^13 - 1 = -64(1 + i) - 1 = -64 - 64i - 1 = -65 - 64i.

Similarly, (1 - i)^13 - 1 = -64(1 - i) -1 = -64 + 64i -1 = -65 + 64i.

Therefore, the product is (-65 - 64i)(-65 + 64i). Let's compute that.

Multiply the two complex numbers: (-65)(-65) + (-65)(64i) + (-64i)(-65) + (-64i)(64i).

First term: 4225

Second term: -65*64i = -4160i

Third term: 64*65i = 4160i

Fourth term: -64*64 i² = -4096*(-1) = 4096

So, adding up: 4225 + 4096 + (-4160i + 4160i) = 8321 + 0i = 8321.

Therefore, the product is 8321. Therefore, the original product is 8321. Then 8321 mod 1000 is 321. So, the remainder when divided by 1000 is 321. So, the answer is 321.

Wait, but let me check once again. Let me verify the key steps again.

1. The product is over k=0 to 12 of (2 - 2ω^k + ω^{2k}).

2. Each term is (ω^k)^2 - 2ω^k + 2 = (ω^k - 1)^2 + 1.

3. Alternatively, factor as (ω^k - (1 + i))(ω^k - (1 - i)).

4. Then, the product over all ω^k (which are 13th roots of unity) of (ω^k - a)(ω^k - b) is equal to (a^13 - 1)(b^13 - 1). Wait, no. Wait, in previous steps, I thought it was (a^13 - 1)(b^13 - 1), but actually, if the polynomial is x^13 - 1, then evaluating at a is a^13 - 1. So, if we take the product over (x - a), then it's a^13 - 1. Therefore, product over (a - x) = 1 - a^13. Wait, but if we have (x - a) for x^13 = 1, then product over (x - a) is (a^13 - 1). Wait, but in the case of the original problem, the product is over (x - a)(x - b), so it's (x - a)(x - b) for x^13 = 1, so the product is (a^13 - 1)(b^13 - 1). Wait, but in the previous calculation, when I factored into (x - (1 + i))(x - (1 - i)), the product over x^13 = 1 of that would be ( (1 + i)^13 - 1 ) ( (1 - i)^13 - 1 ). But in the previous step, in my first approach, I thought it was [1 - (1 + i)^13][1 - (1 - i)^13], which is different. So, which is correct?

Wait, confusion arises from whether the product is over (x - a) or (a - x). Let me clarify.

If P(x) = x^13 - 1, then the product over (x - a_i) where a_i are roots of P(x) is equal to P(a) = a^13 - 1. Therefore, product over (x - a_i) = a^13 - 1. Therefore, if we have two factors, (x - a)(x - b), then the product over x^13 =1 is (a^13 - 1)(b^13 - 1). Therefore, in this problem, the product is [(1 + i)^13 - 1][(1 - i)^13 - 1] = (-65 - 64i -1)(-65 + 64i -1) = (-66 - 64i)(-66 + 64i) = (-66)^2 - (64i)^2 = 4356 - (-4096) = 4356 + 4096 = 8452. Wait, that contradicts the previous result. Wait, now I'm confused.

Wait, let's do it step by step.

If P(x) = x^13 - 1, then product over (x - a_i) = P(a) = a^13 - 1. Therefore, if we have two factors, (x - a)(x - b), then product over (x - a)(x - b) over all x roots is (a^13 -1)(b^13 -1). Therefore, in our case, a = 1 + i, b = 1 - i. Therefore, product is [(1 + i)^13 -1][(1 - i)^13 -1]. Which is exactly what we computed earlier as (-65 -64i)(-65 +64i) = 8321. So, 8321. So, the answer is 8321, which mod 1000 is 321.

But in the other approach, where we thought it was [1 - a^13][1 - b^13], which would be [1 - (-64(1 + i))][1 - (-64(1 - i))] = [1 +64(1 +i)][1 +64(1 -i)] = (65 +64i)(65 -64i) = 8321. So, same result. Therefore, both approaches give the same answer. So, the confusion was because of the different ways of expressing the product.

Therefore, the answer is 8321, which mod 1000 is 321.

Therefore, the remainder is 321.

But let me confirm once more with another approach.

Alternative approach: Let’s compute the product over k=0 to 12 of (2 - 2ω^k + ω^{2k}).

Note that ω^k are the 13th roots of unity, so ω^k = e^{2πik/13}.

Let’s see if we can relate this product to some known value. But since each term is quadratic in ω^k, and the product is over all roots, perhaps the product can be related to the value of a certain polynomial evaluated at specific points.

But given that we already did the computation by factoring into (1 + i) and (1 - i), and arrived at 8321, which mod 1000 is 321, and that seems consistent, I think that's the answer.

Alternatively, perhaps compute the product numerically.

Compute each term (2 - 2ω^k + ω^{2k}) for k=0 to 12, multiply them all together, and take mod 1000. But since ω^k are complex numbers, multiplying them all would result in a complex number, but the product should be real because the terms come in conjugate pairs. Let me check for a few terms.

For k=0: (2 - 2*1 + 1) = (2 - 2 +1) =1.

For k=1: 2 - 2ω + ω².

For k=12: 2 - 2ω^{12} + ω^{24}. But ω^{12} = ω^{-1}, since ω^{13}=1. So, ω^{24} = ω^{-2}. Therefore, the term for k=12 is 2 - 2ω^{-1} + ω^{-2} = conjugate of (2 - 2ω + ω²), since conjugate(ω) = ω^{-1} and conjugate(ω²) = ω^{-2}. Therefore, the product of terms for k=1 and k=12 is |2 - 2ω + ω²|². Similarly, for k=2 and k=11, their terms are conjugates, so their product is |2 - 2ω² + ω⁴|², etc. Therefore, the total product is the product over k=0 to 6 of the modulus squared of (2 - 2ω^k + ω^{2k}) for k=0, and then the rest as pairs.

But since k=0 gives 1, the total product is |1|² * product over k=1 to 6 of |2 - 2ω^k + ω^{2k}|² * product over k=7 to 12 of |2 - 2ω^k + ω^{2k}|. Wait, but since k=12 is conjugate of k=1, etc., maybe the entire product is real. But actually, since when k runs from 1 to 12, the terms come in conjugate pairs, the product is real. Therefore, the total product is real, and positive.

But since we already computed it using the cyclotomic polynomial approach, and got 8321, which is 321 mod 1000, maybe that's correct.

Alternatively, maybe compute the product numerically:

But given that this is a 13th root, the product might be hard to compute numerically without a calculator. However, since we already have an exact answer, 8321, and 8321 mod 1000 is 321, I think that's the correct answer.

Therefore, the remainder when the product is divided by 1000 is 321.

**Final Answer**
\boxed{321}
Therefore, the remainder when the product is divided by 1000 is $\boxed{321}$.
</think>